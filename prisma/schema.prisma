generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model attendance {
  id              Int               @id @default(autoincrement())
  courseCode      String            @db.VarChar(4)
  percentaje      Decimal           @db.Decimal(5, 2)
  createdAt       DateTime?         @default(now()) @db.DateTime(0)
  createdBy       String?           @db.VarChar(100)
  updatedAt       DateTime?         @db.DateTime(0)
  updatedBy       String?           @db.VarChar(100)
  courses         courses           @relation(fields: [courseCode], references: [code], onDelete: NoAction, onUpdate: NoAction, map: "fk_courseCode_attendance")
  attendancelines attendancelines[]

  @@index([courseCode], map: "fk_courseCode_attendance_idx")
}

model attendancelines {
  id            Int        @id @default(autoincrement())
  attendaceId   Int
  studentCedula String     @db.VarChar(4)
  description   String     @db.VarChar(50)
  createdAt     DateTime?  @default(now()) @db.DateTime(0)
  createdBy     String?    @db.VarChar(100)
  updatedAt     DateTime?  @db.DateTime(0)
  updatedBy     String?    @db.VarChar(100)
  students      students   @relation(fields: [studentCedula], references: [cedula], onDelete: NoAction, onUpdate: NoAction, map: "dk_studentCedula_attendanceLiness")
  attendance    attendance @relation(fields: [attendaceId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_attendaceId_attendandeLines")

  @@index([studentCedula], map: "dk_studentCedula_attendanceLiness_idx")
  @@index([attendaceId], map: "fk_attendaceId_attendandeLines_idx")
}

model comments {
  id          Int       @id @default(autoincrement())
  description String    @db.VarChar(100)
  createdAt   DateTime? @default(now()) @db.DateTime(0)
}

model courses {
  code                   String        @id @unique(map: "code_UNIQUE") @db.VarChar(4)
  name                   String        @db.VarChar(100)
  durationHours          Int
  numberStudentsEnrolled Int
  schedule               String?       @db.VarChar(500)
  startDate              DateTime?     @db.Date
  endDate                DateTime?     @db.Date
  quota                  Int
  createdAt              DateTime?     @default(now()) @db.DateTime(0)
  createdBy              String?       @db.VarChar(100)
  updatedAt              DateTime?     @db.DateTime(0)
  updatedBy              String?       @db.VarChar(100)
  attendance             attendance[]
  enrollment             enrollment[]
  evaluations            evaluations[]
  usercourses            usercourses[]
}

model enrollment {
  id            Int       @id @default(autoincrement())
  courseCode    String    @db.VarChar(4)
  studentCedula String    @db.VarChar(12)
  createdAt     DateTime? @default(now()) @db.DateTime(0)
  createdBy     String?   @db.VarChar(100)
  courses       courses   @relation(fields: [courseCode], references: [code], onDelete: NoAction, onUpdate: NoAction, map: "fk_courseCode_enrollment")
  students      students  @relation(fields: [studentCedula], references: [cedula], onDelete: NoAction, onUpdate: NoAction, map: "fk_studentCedula_enrollment")

  @@index([courseCode], map: "fk_courseCode_enrollment_idx")
  @@index([studentCedula], map: "fk_studentCedula_enrollment_idx")
}

model evaluations {
  id               Int             @id @default(autoincrement())
  courseCode       String          @db.VarChar(4)
  name             String          @db.VarChar(100)
  percentaje       Decimal         @db.Decimal(5, 2)
  points           Int
  isAutoCalculated Boolean
  createdAt        DateTime?       @default(now()) @db.DateTime(0)
  createdBy        String?         @db.VarChar(100)
  updatedAt        DateTime?       @db.DateTime(0)
  updatedBy        String?         @db.VarChar(100)
  courses          courses         @relation(fields: [courseCode], references: [code], onDelete: NoAction, onUpdate: NoAction, map: "fk_courseCode_evaluations")
  grades           grades[]
  gradesheaders    gradesheaders[]

  @@index([courseCode], map: "fk_courseCode_evaluations_idx")
}

model grades {
  id            Int         @id @default(autoincrement())
  studentCedula String      @db.VarChar(12)
  evaluationId  Int
  points        Int
  feedback      String?     @db.VarChar(500)
  createdAt     DateTime?   @default(now()) @db.DateTime(0)
  createdBy     String?     @db.VarChar(100)
  updatedAt     DateTime?   @db.DateTime(0)
  updatedBy     String?     @db.VarChar(100)
  evaluations   evaluations @relation(fields: [evaluationId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_evaluationId_grades")
  students      students    @relation(fields: [studentCedula], references: [cedula], onDelete: NoAction, onUpdate: NoAction, map: "fk_studentCedula_grades")

  @@index([evaluationId], map: "fk_evaluationId_grades_idx")
  @@index([studentCedula], map: "fk_studentCedula_grades_idx")
}

model gradesheaders {
  id           Int           @id
  evaluationId Int
  name         String        @db.VarChar(100)
  points       Int
  createdAt    DateTime?     @default(now()) @db.DateTime(0)
  createdBy    String?       @db.VarChar(100)
  updatedAt    DateTime?     @db.DateTime(0)
  updatedBy    String?       @db.VarChar(100)
  evaluations  evaluations   @relation(fields: [evaluationId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_evaluationId_gradesheaders")
  gradeslines  gradeslines[]

  @@index([evaluationId], map: "fk_evaluationId_gradesheaders_idx")
}

model gradeslines {
  id            Int           @id
  gradeHeaderId Int
  studentCedula String        @db.VarChar(12)
  points        Int
  feedback      String?       @db.VarChar(500)
  createdAt     DateTime?     @default(now()) @db.DateTime(0)
  createdBy     String?       @db.VarChar(100)
  updatedAt     DateTime?     @db.DateTime(0)
  updatedBy     String?       @db.VarChar(100)
  gradesheaders gradesheaders @relation(fields: [gradeHeaderId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_gradeHeaderId_gradeslines")
  students      students      @relation(fields: [studentCedula], references: [cedula], onDelete: NoAction, onUpdate: NoAction, map: "fk_studentCedula_gradeslines")

  @@index([gradeHeaderId], map: "fk_gradeHeaderId_gradeslines_idx")
  @@index([studentCedula], map: "fk_studentCedula_gradeslines_idx")
}

model students {
  cedula                String            @id @unique(map: "cedula_UNIQUE") @db.VarChar(12)
  name                  String            @db.VarChar(50)
  lastname              String            @db.VarChar(50)
  bornDate              DateTime          @db.Date
  gender                String            @db.VarChar(25)
  phone                 String            @db.VarChar(20)
  email                 String            @db.VarChar(75)
  disability            String            @db.VarChar(15)
  disabilityDescription String?           @db.VarChar(100)
  provincia             String?           @db.VarChar(80)
  canton                String?           @db.VarChar(80)
  distrito              String?           @db.VarChar(80)
  comunidad             String?           @db.VarChar(80)
  observations          String?           @db.VarChar(500)
  createdAt             DateTime?         @default(now()) @db.DateTime(0)
  createdBy             String?           @db.VarChar(100)
  updatedAt             DateTime?         @db.DateTime(0)
  updatedBy             String?           @db.VarChar(100)
  attendancelines       attendancelines[]
  enrollment            enrollment[]
  grades                grades[]
  gradeslines           gradeslines[]
}

model usercourses {
  id         Int     @id @default(autoincrement())
  userId     Int
  courseCode String  @db.VarChar(4)
  courses    courses @relation(fields: [courseCode], references: [code], onDelete: NoAction, onUpdate: NoAction, map: "fk_courseCode_usercourses")
  users      users   @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_userId_usercourses")

  @@index([courseCode], map: "fk_courseCode_usercourses_idx")
  @@index([userId], map: "fk_userId_usercourses_idx")
}

model users {
  id          Int           @id @default(autoincrement())
  name        String        @db.VarChar(50)
  lastname    String        @db.VarChar(50)
  email       String        @db.VarChar(75)
  password    String        @db.VarChar(60)
  createdAt   DateTime?     @default(now()) @db.DateTime(0)
  updatedAt   DateTime?     @db.DateTime(0)
  usercourses usercourses[]
}
